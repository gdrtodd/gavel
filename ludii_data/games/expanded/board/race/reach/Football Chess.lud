(game "Football Chess" (players 2) (equipment {(board (square 9)) (piece "Rook" Each (move Slide Orthogonal (to (apply if:(not (is In (to) (sites "Goals"))))))) (piece "King" Each (move Step (to if:(and (is Empty (to)) (not (is In (to) (sites "Goals"))))))) (piece "Bishop" Each (move Slide Diagonal (to (apply if:(not (is In (to) (sites "Goals"))))))) (piece "Knight" Each (move Leap {{F F R F} {F F L F}} (to if:(and (is Empty (to)) (not (is In (to) (sites "Goals"))))))) (piece "Queen" Each (move Slide (to (apply if:(not (is In (to) (sites "Goals"))))))) (piece "Ball" Shared) (regions "Goals" (sites {"E1" "E9"})) (map "Goal" {(pair P1 "E9") (pair P2 "E1")})}) (rules (meta (no Repeat PositionalInTurn)) (start {(place "Rook1" {"A1" "I1"}) (place "Knight1" {"B1" "H1"}) (place "Bishop1" {"C1" "G1"}) (place "Queen1" coord:"D1") (place "King1" coord:"F1") (place "Rook2" {"A9" "I9"}) (place "Knight2" {"B9" "H9"}) (place "Bishop2" {"C9" "G9"}) (place "Queen2" coord:"D9") (place "King2" coord:"F9") (place "Ball" {"E5"})}) (play (if (is Prev Mover) (or (if (is Pending) (forEach Site (sites Around (where "Ball" Shared)) (if (and (= (what at:(site)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (site)))))) (if (and (= (what at:(site)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (site) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(site)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (site) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (site) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between))))))))))))) (then (if (can Move (forEach Site (sites Around (where "Ball" Shared)) (if (and (= (what at:(site)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (site)))))) (if (and (= (what at:(site)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (site) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(site)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (site) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (site) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between))))))))))))))) (and (set Pending) (moveAgain))))) (if (and (= (what at:(last To)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (last To)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (last To)))))) (if (and (= (what at:(last To)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (last To)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (last To) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(last To)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (last To)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (between if:(if (is In (last To) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(last To)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (last To) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (between if:(if (is In (last To) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(last To)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (last To) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (between if:(if (is In (last To) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))))))) (then (if (can Move (forEach Site (sites Around (where "Ball" Shared)) (if (and (= (what at:(site)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (site)))))) (if (and (= (what at:(site)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (site) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(site)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (site) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (site) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between))))))))))))))) (and (set Pending) (moveAgain)))))) (move Pass)) (or (forEach Piece (then (if (can Move (if (and (= (what at:(last To)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (last To)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (last To)))))) (if (and (= (what at:(last To)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (last To)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (last To) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(last To)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (last To)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (between if:(if (is In (last To) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(last To)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (last To) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (between if:(if (is In (last To) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(last To)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (last To) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(last To) to:(where "Ball" Shared)) (between if:(if (is In (last To) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))))))))) (moveAgain)))) (forEach Site (sites Around (where "Ball" Shared)) (if (and (= (what at:(site)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (site)))))) (if (and (= (what at:(site)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (site) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(site)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (site) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (site) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between))))))))))))) (then (if (can Move (forEach Site (sites Around (where "Ball" Shared)) (if (and (= (what at:(site)) (id "Knight" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (leap (from (where "Ball" Shared)) {{F F R F} {F F L F}} (to if:(is Empty (to))))) if:(not (is In (to) (sites Around (site)))))) (if (and (= (what at:(site)) (id "King" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (step (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (to if:(is Empty (to))))) if:(if (is In (site) (union (sites Bottom) (sites Top))) (not (is In (to) (sites "Goals"))) True))) (if (and (= (what at:(site)) (id "Queen" Mover)) (is In (where "Ball" Shared) (sites Around (site)))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Rook" Mover)) (is In (where "Ball" Shared) (sites Around (site) Orthogonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between)))))))) (if (and (= (what at:(site)) (id "Bishop" Mover)) (is In (where "Ball" Shared) (sites Around (site) Diagonal))) (move (from (where "Ball" Shared)) (to (sites To (slide (from (where "Ball" Shared)) (directions Cell from:(site) to:(where "Ball" Shared)) (between if:(if (is In (site) (union (sites Bottom) (sites Top))) (and (is Empty (between)) (not (is In (between) (sites "Goals")))) (is Empty (between))))))))))))))) (and (set Pending) (moveAgain)))))))) (end {(if (= (where "Ball" Shared) (mapEntry P1)) (result P1 Win)) (if (= (where "Ball" Shared) (mapEntry P2)) (result P2 Win))}))) 