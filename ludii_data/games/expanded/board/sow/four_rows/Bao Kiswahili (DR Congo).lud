(game "Bao Kiswahili (DR Congo)" (players 2) (equipment {(mancalaBoard 4 8 store:None {(track "TrackCCW1" "0,E,N1,W" loop:True P1) (track "TrackCCW2" "16,E,N1,W" loop:True P2) (track "TrackCW1" "7,W,N1,E" loop:True P1) (track "TrackCW2" "23,W,N1,E" loop:True P2)}) (piece "Seed" Shared) (hand Each) (regions "Home" P1 (expand (sites Bottom))) (regions "Home" P2 (expand (sites Top))) (regions "Inner" P1 (sites Row 1)) (regions "Inner" P2 (sites Row 2)) (map "LeftMostInner" {(pair P1 8) (pair P2 23)}) (map "RightMostInner" {(pair P1 15) (pair P2 16)}) (map "AdjacentLeftMostInner" {(pair P1 9) (pair P2 22)}) (map "AdjacentRightMostInner" {(pair P1 14) (pair P2 17)})}) (rules (start {(set Count 24 at:(handSite P1)) (set Count 24 at:(handSite P2)) (set Count 1 to:(union (sites Row 1) (sites Row 2)))}) phases:{(phase "Placement" (play (if (is Prev Mover) (if (is Pending) (or (if (or (= 1 (value Player Mover)) (= 0 (value Player Mover))) (do (fromTo (from (if (is Mover P1) (+ (last To afterConsequence:True) 8) (- (last To afterConsequence:True) 8))) (to (mapEntry "LeftMostInner" Mover)) count:(count at:(if (is Mover P1) (+ (last To afterConsequence:True) 8) (- (last To afterConsequence:True) 8)))) next:(move Select (from (mapEntry "LeftMostInner" Mover)) (then (sow "TrackCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (+ (to) 8) (- (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)})))))))) (if (or (= 2 (value Player Mover)) (= 0 (value Player Mover))) (do (fromTo (from (if (is Mover P1) (+ (last To afterConsequence:True) 8) (- (last To afterConsequence:True) 8))) (to (mapEntry "RightMostInner" Mover)) count:(count at:(if (is Mover P1) (+ (last To afterConsequence:True) 8) (- (last To afterConsequence:True) 8)))) next:(move Select (from (mapEntry "RightMostInner" Mover)) (then (sow "TrackCCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (+ (to) 8) (- (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))))))))) (or (if (or (= (var "Direction") 1) (= (var "Direction") 3)) (move Select (from (var "Replay")) (then (sow "TrackCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (+ (to) 8) (- (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))))))) (if (or (= (var "Direction") 2) (= (var "Direction") 3)) (move Select (from (var "Replay")) (then (sow "TrackCCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (+ (to) 8) (- (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))) (if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))))))))) (if (is Occupied (handSite Mover)) (priority {(move (from (handSite Mover)) (to (sites Mover "Inner") if:(is Occupied (if (is Mover P1) (+ (to) 8) (- (to) 8)))) count:1 (then (and {(moveAgain) (set Pending) (if (is In (last To) (expand (sites Right))) (set Value Mover 2) (if (is In (last To) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}))) (move (from (handSite Mover)) (to (sites Mover "Inner")) count:1 (then (and {(moveAgain) (set Var "Replay" (last To)) (set Var "Direction" 3)})))}) (or (move Select (from (sites Mover) if:(is Occupied (from))) (then (sow "TrackCW" owner:(mover) apply:(if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))))) (move Select (from (sites Mover) if:(is Occupied (from))) (then (sow "TrackCCW" owner:(mover) apply:(if (< 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))))))))))} (end (forEach Player if:(all Sites (sites Player "Inner") if:(= 0 (count at:(site)))) (result Player Loss))))) 