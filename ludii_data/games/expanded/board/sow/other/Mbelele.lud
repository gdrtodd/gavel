(game "Mbelele" (players 2) (equipment {(board (merge {(rectangle 2 12) (shift -1 0.5 (square 1)) (shift -3 0 (square 2)) (shift -4 0.5 (square 1)) (shift 12 0.5 (square 1)) (shift 13 0 (square 2)) (shift 15 0.5 (square 1))}) {(track "TrackCCW1" "25,26,24,0,E,31,32,35" loop:True P1) (track "TrackCCW2" "34,33,30,23,W,28,27,29" loop:True P2) (track "TrackCW1" "35,32,31,11,W,24,26,25" loop:True P1) (track "TrackCW2" "29,27,28,12,E,30,33,34" loop:True P2)} use:Vertex) (piece "Seed" Shared) (map "Opposite" {(pair 29 35) (pair 35 29) (pair 24 30) (pair 30 24) (pair 25 27) (pair 26 28) (pair 0 12) (pair 1 13) (pair 2 14) (pair 3 15) (pair 4 16) (pair 5 17) (pair 6 18) (pair 7 19) (pair 8 20) (pair 9 21) (pair 10 22) (pair 11 23) (pair 31 33) (pair 32 34) (pair 27 25) (pair 28 26) (pair 12 0) (pair 13 1) (pair 14 2) (pair 15 3) (pair 16 4) (pair 17 5) (pair 18 6) (pair 19 7) (pair 20 8) (pair 21 9) (pair 22 10) (pair 23 11) (pair 33 31) (pair 34 32)}) (regions P1 (union (sites Bottom) (sites {24 35}))) (regions P2 (union (sites Top) (sites {29 30})))}) (rules (start (set Count 3 to:(sites Board))) (play (or (if (!= 2 (var "NumCapture")) (or (if (!= (var "Direction") 2) (move Select (from (if (is Prev Mover) (sites {(var "Replay")}) (sites Mover)) if:(and (if (is Prev Mover) True (= 1 (count at:(from)))) (is Occupied (from)))) (then (sow "TrackCCW" owner:(mover) apply:(if (= 1 (count at:(to))) (and {(if (is Occupied (mapEntry "Opposite" (to))) (remove (mapEntry "Opposite" (to)) count:1)) (set Var "Direction" 0) (set Var "NumCapture" 0)}) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1) (set Var "NumCapture" 1)})))))) (if (!= (var "Direction") 1) (move Select (from (if (is Prev Mover) (sites {(var "Replay")}) (sites Mover)) if:(and (if (is Prev Mover) True (= 1 (count at:(from)))) (is Occupied (from)))) (then (sow "TrackCW" owner:(mover) apply:(if (= 1 (count at:(to))) (and {(if (is Occupied (mapEntry "Opposite" (to))) (remove (mapEntry "Opposite" (to)) count:1)) (set Var "Direction" 0) (set Var "NumCapture" 0)}) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2) (set Var "NumCapture" 1)})))))))) (if (!= 1 (var "NumCapture")) (or (if (!= (var "Direction") 2) (move Select (from (if (is Prev Mover) (sites {(var "Replay")}) (sites Mover)) if:(and (if (is Prev Mover) True (< 1 (count at:(from)))) (is Occupied (from)))) (then (sow "TrackCCW" owner:(mover) apply:(if (= 1 (count at:(to))) (and {(if (is Occupied (mapEntry "Opposite" (to))) (remove (mapEntry "Opposite" (to)) count:(count at:(to)))) (set Var "Direction" 0) (set Var "NumCapture" 0)}) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1) (set Var "NumCapture" 2)})))))) (if (!= (var "Direction") 1) (move Select (from (if (is Prev Mover) (sites {(var "Replay")}) (sites Mover)) if:(and (if (is Prev Mover) True (< 1 (count at:(from)))) (is Occupied (from)))) (then (sow "TrackCW" owner:(mover) apply:(if (= 1 (count at:(to))) (and {(if (is Occupied (mapEntry "Opposite" (to))) (remove (mapEntry "Opposite" (to)) count:(count at:(to)))) (set Var "Direction" 0) (set Var "NumCapture" 1)}) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2) (set Var "NumCapture" 2)})))))))))) (end (forEach NonMover if:(all Sites (sites Player) if:(= 0 (count at:(site)))) (result Player Loss))))) 