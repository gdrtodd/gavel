(game "Iyogh" (players 2) (equipment {(mancalaBoard 2 8 store:None {(track "TrackCCW" "0,E,N,W" loop:True) (track "TrackCW" "7,W,N,E" loop:True)}) (piece "Seed" Shared) (regions P1 (sites Bottom)) (regions P2 (sites Top)) (hand Each) (map "LeftMost" {(pair P1 0) (pair P2 15)}) (map "RightMost" {(pair P1 7) (pair P2 8)}) (regions "RightMost" P1 (sites {5 6})) (regions "RightMost" P2 (sites {9 10}))}) (rules (start (set Count 4 to:(sites Track))) phases:{(phase "Opening" (play (move (from (sites Mover "RightMost") if:(is Occupied (from))) (to (mapEntry "RightMost" Mover)) count:(count at:(from)))) (nextPhase Mover (all Sites (sites Mover "RightMost") if:(is Empty (site))) "Sowing")) (phase "Sowing" (play (or {(if (is Occupied Cell (handSite Mover)) (forEach Value min:1 max:(count Cell at:(handSite Mover)) (do (set Var "NumToSow" (value)) next:(move (from Cell (handSite Mover)) (to (mapEntry "LeftMost" Mover)) count:(value) (then (and (sow count:(var "NumToSow") "TrackCCW" if:(or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) apply:(if (or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) (fromTo (from (if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))) (to (handSite Mover)) count:(count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) forward:True) (set Var "NumToSow" 0))))))) (if (is Occupied Cell (handSite Mover)) (forEach Value min:1 max:(count Cell at:(handSite Mover)) (do (set Var "NumToSow" (value)) next:(move (from Cell (handSite Mover) if:(or (= 1 (count at:(if (is In (trackSite Move from:(mapEntry "LeftMost" Mover) "TrackCW" steps:(value)) (sites Bottom)) (+ (trackSite Move from:(mapEntry "LeftMost" Mover) "TrackCW" steps:(value)) 8) (- (trackSite Move from:(mapEntry "LeftMost" Mover) "TrackCW" steps:(value)) 8)))) (= 3 (count at:(if (is In (trackSite Move from:(mapEntry "LeftMost" Mover) "TrackCW" steps:(value)) (sites Bottom)) (+ (trackSite Move from:(mapEntry "LeftMost" Mover) "TrackCW" steps:(value)) 8) (- (trackSite Move from:(mapEntry "LeftMost" Mover) "TrackCW" steps:(value)) 8)))))) (to (mapEntry "LeftMost" Mover)) count:(value) (then (and (sow count:(var "NumToSow") "TrackCW" if:(or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) apply:(if (or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) (fromTo (from (if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))) (to (handSite Mover)) count:(count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) forward:True) (set Var "NumToSow" 0))))))) (move Select (from (sites Mover) if:(< 0 (count at:(from)))) (then (sow "TrackCCW" if:(or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) apply:(if (or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) (fromTo (from (if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))) (to (handSite Mover)) count:(count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) forward:True))) (move Select (from (sites Mover) if:(and (< 0 (count at:(from))) (or (= 1 (count at:(if (is In (trackSite Move from:(from) "TrackCW" steps:(count at:(from))) (sites Bottom)) (+ (trackSite Move from:(from) "TrackCW" steps:(count at:(from))) 8) (- (trackSite Move from:(from) "TrackCW" steps:(count at:(from))) 8)))) (= 3 (count at:(if (is In (trackSite Move from:(from) "TrackCW" steps:(count at:(from))) (sites Bottom)) (+ (trackSite Move from:(from) "TrackCW" steps:(count at:(from))) 8) (- (trackSite Move from:(from) "TrackCW" steps:(count at:(from))) 8))))))) (then (sow "TrackCW" if:(or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) apply:(if (or (= 1 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8)))) (= 3 (count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) (fromTo (from (if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))) (to (handSite Mover)) count:(count at:(if (is In (to) (sites Bottom)) (+ (to) 8) (- (to) 8))))) forward:True)))})))} (end (forEach Player if:(all Sites (sites Player) if:(= 0 (count at:(site)))) (result Player Loss))))) 