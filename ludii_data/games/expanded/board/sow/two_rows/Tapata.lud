(game "Tapata" (players 2) (equipment {(mancalaBoard 2 12 store:None (track "TrackCCW" "0,E,N,W" loop:True)) (piece "Seed" Shared) (regions "Home" P1 (sites Bottom)) (regions "Home" P2 (sites Top)) (regions "Right Half" P1 (intersection (sites Bottom) (expand (sites Right) steps:5))) (regions "Right Half" P2 (intersection (sites Top) (expand (sites Left) steps:5))) (map {(pair P1 0) (pair P2 23)})}) (rules (start (set Count 3 to:(sites {1 2 4 5 7 8 10 11 22 21 19 18 16 15 13 12}))) phases:{(phase "FirstMove" (play (move Select (from (difference (sites Mover "Right Half") (sites Empty))) (then (sow apply:(if (is In (to) (sites Mover "Home")) (fromTo (from (to)) (to (mapEntry Next)))))))) (nextPhase Mover "Play")) (phase "Play" (play (move Select (from (if (is Prev Mover) (sites {(last To afterConsequence:True)}) (sites Mover "Home")) if:(and (> (count at:(from)) 0) (or (is Prev Mover) (and (not (is Prev Mover)) (not (and (is In (trackSite Move from:(from) steps:(count at:(from))) (sites Mover "Home")) (!= 0 (count at:(trackSite Move from:(from) steps:(count at:(from))))))))))) (then (sow apply:(if (< 1 (count at:(to))) (moveAgain) (if (and (!= 0 (count at:(if (is Mover P1) (+ (to) 12) (- (to) 12)))) (is In (to) (sites Mover "Home"))) (remove (if (is Mover P1) (+ (to) 12) (- (to) 12))))))))))} (end (forEach NonMover if:(= (count in:(sites Player "Home")) 0) (result Player Loss))))) 