(game "Ti" (players 2) (equipment {(mancalaBoard 2 6 (track "Track" "1,E,N,W" loop:True)) (regions "Home" P1 (sites Bottom)) (regions "Home" P2 (sites Top)) (map {(pair P1 FirstSite) (pair P2 LastSite)}) (piece "Seed" Shared)}) (rules (start (set Count 4 to:(sites Track))) phases:{(phase "TwoFirstTurn" (play (if (is Prev Mover) (forEach Value min:1 max:(var "NumCounters") (move Add (piece (id "Seed" Shared)) (to (trackSite Move from:(last To) "Track" steps:1) (apply (set Var "NumCounters" (- (var "NumCounters") (value))))) count:(value) (then (if (< 0 (var "NumCounters")) (moveAgain) (set Value Mover (+ 1 (value Player Mover))))))) (move Select (from (sites Mover "Home") if:(> (count at:(from)) 0)) (then (and {(moveAgain) (remove (last To) count:(count at:(last To))) (set Var "NumCounters" (count at:(last To)))}))))) (nextPhase Mover (= (value Player Mover) 1) "Sowing")) (phase "Sowing" (play (do (or (move Select (from (sites Mover "Home") if:(> (count at:(from)) 1)) (then (sow if:(or (= (count at:(to)) 2) (= (count at:(to)) 3)) apply:(fromTo (from (to)) (to (mapEntry (mover))) count:(count at:(to))) includeSelf:False backtracking:True))) (move Select (from (sites Mover "Home") if:(= (count at:(from)) 1)) (then (sow)))) ifAfterwards:(< 0 (count in:(sites Next "Home"))))))} (end (if (no Moves Mover) (byScore {(score P1 (+ (count at:(mapEntry P1)) (count in:(sites P1)))) (score P2 (+ (count at:(mapEntry P2)) (count in:(sites P2))))}))))) 