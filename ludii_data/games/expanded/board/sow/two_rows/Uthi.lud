(game "Uthi" (players 2) (equipment {(mancalaBoard 2 8 {(track "TrackCW" "8,W,N,E" loop:True) (track "TrackCCW" "1,E,N,W" loop:True)}) (regions P1 (sites Bottom)) (regions P2 (sites Top)) (map {(pair P1 FirstSite) (pair P2 LastSite)}) (piece "Seed" Shared)}) (rules (start (set Count 5 to:(sites Track))) phases:{(phase "Opening" (play (or (move Select (from (sites Mover)) (then (and (fromTo (from (last To)) (to (trackSite Move from:(last To) "TrackCW" steps:1)) count:3) (fromTo (from (last To)) (to (trackSite Move from:(last To) "TrackCW" steps:2)) count:2)))) (move Select (from (sites Mover)) (then (and (fromTo (from (last To)) (to (trackSite Move from:(last To) "TrackCCW" steps:1)) count:3) (fromTo (from (last To)) (to (trackSite Move from:(last To) "TrackCCW" steps:2)) count:2)))))) (nextPhase Mover "Sowing")) (phase "Sowing" (play (or (if (!= (value Player Mover) 1) (move Select (from (if (is Prev Mover) (sites {(last To afterConsequence:True)}) (sites Mover)) if:(> (count at:(from)) 0)) (then (sow "TrackCW" apply:(if (> (count at:(to)) 1) (and {(moveAgain) (set Value Mover 1) (if (is In (to) (sites Next)) (set Var "GoInOpponentRow" 1))}) (and {(set Value Mover 0) (set Var "GoInOpponentRow" 0) (if (and (= 1 (var "GoInOpponentRow")) (is In (to) (sites Mover))) (if (!= 0 (count at:(if (is Mover P1) (+ (to) 8) (- (to) 8)))) (fromTo (from (if (is Mover P1) (+ (to) 8) (- (to) 8))) (to (mapEntry Mover)) count:(count at:(if (is Mover P1) (+ (to) 8) (- (to) 8))) (then (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:1)) (is In (trackSite Move from:(last From) "TrackCW" steps:1) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:1))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:1)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:1)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:2)) (is In (trackSite Move from:(last From) "TrackCW" steps:2) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:2))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:2)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:2)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:3)) (is In (trackSite Move from:(last From) "TrackCW" steps:3) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:3))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:3)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:3)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:4)) (is In (trackSite Move from:(last From) "TrackCW" steps:4) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:4))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:4)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:4)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:5)) (is In (trackSite Move from:(last From) "TrackCW" steps:5) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:5))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:5)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:5)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:6)) (is In (trackSite Move from:(last From) "TrackCW" steps:6) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:6))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:6)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:6)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCW" steps:7)) (is In (trackSite Move from:(last From) "TrackCW" steps:7) (sites Mover))) (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCW" steps:7))) (fromTo (from (trackSite Move from:(last From) "TrackCW" steps:7)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCW" steps:7)))))))))))))))))))))})))))) (if (!= (value Player Mover) 2) (move Select (from (if (is Prev Mover) (sites {(last To afterConsequence:True)}) (sites Mover)) if:(> (count at:(from)) 0)) (then (sow "TrackCCW" apply:(if (> (count at:(to)) 1) (and {(moveAgain) (set Value Mover 2) (if (is In (to) (sites Next)) (set Var "GoInOpponentRow" 1))}) (and {(set Value Mover 0) (set Var "GoInOpponentRow" 0) (if (and (= 1 (var "GoInOpponentRow")) (is In (to) (sites Mover))) (if (!= 0 (count at:(if (is Mover P1) (+ (to) 8) (- (to) 8)))) (fromTo (from (if (is Mover P1) (+ (to) 8) (- (to) 8))) (to (mapEntry Mover)) count:(count at:(if (is Mover P1) (+ (to) 8) (- (to) 8))) (then (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:1)) (is In (trackSite Move from:(last From) "TrackCCW" steps:1) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:1))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:1)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:1)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:2)) (is In (trackSite Move from:(last From) "TrackCCW" steps:2) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:2))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:2)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:2)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:3)) (is In (trackSite Move from:(last From) "TrackCCW" steps:3) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:3))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:3)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:3)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:4)) (is In (trackSite Move from:(last From) "TrackCCW" steps:4) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:4))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:4)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:4)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:5)) (is In (trackSite Move from:(last From) "TrackCCW" steps:5) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:5))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:5)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:5)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:6)) (is In (trackSite Move from:(last From) "TrackCCW" steps:6) (sites Mover))) (and (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:6))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:6)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:6)))) (if (and (is Empty (trackSite Move from:(last From) "TrackCCW" steps:7)) (is In (trackSite Move from:(last From) "TrackCCW" steps:7) (sites Mover))) (if (!= 0 (count at:(trackSite Move from:(last From) "TrackCCW" steps:7))) (fromTo (from (trackSite Move from:(last From) "TrackCCW" steps:7)) (to (mapEntry Mover)) count:(count at:(trackSite Move from:(last From) "TrackCCW" steps:7)))))))))))))))))))))})))))))))} (end (if (no Moves Mover) (byScore {(score P1 (count at:(mapEntry P1))) (score P2 (count at:(mapEntry P2)))}))))) 