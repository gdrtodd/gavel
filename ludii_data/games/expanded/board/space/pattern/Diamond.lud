(game "Diamond" (players 2) (equipment {(board (rotate 90 (tiling T33434 3)) use:Vertex) (piece "Disc" Each (move Step (to if:(is Empty (to))) (then (if (= 1 (count Sites in:(forEach (sites Incident Cell of:Vertex at:(last To)) if:(and {(= 3 (count Sites in:(sites Incident Vertex of:Cell at:(site)))) (= 2 (count Sites in:(forEach (sites Incident Vertex of:Cell at:(site)) if:(is Mover (who at:(site)))))) (= 1 (count Sites in:(forEach (sites Incident Vertex of:Cell at:(site)) if:(is Next (who at:(site))))))})))) (forEach Site (sites Incident Cell of:Vertex at:(last To)) (if (and {(= 3 (count Sites in:(sites Incident Vertex of:Cell at:(site)))) (= 2 (count Sites in:(forEach (sites Incident Vertex of:Cell at:(site)) if:(is Mover (who at:(site)))))) (= 1 (count Sites in:(forEach (sites Incident Vertex of:Cell at:(site)) if:(is Next (who at:(site))))))}) (and (forEach Site (forEach (sites Incident Vertex of:Cell at:(site)) if:(is Next (who at:(site)))) (and (remove (site)) (add (piece (id "Disc" Neutral)) (to (site))))) (set Counter)))))))) (piece "Disc" Neutral) (hand Each) (regions P1 {(sites Side W) (sites Side E)}) (regions P2 {(sites Side N) (sites Side S)})}) (rules (meta (swap)) (start (place "Disc" "Hand" count:12)) phases:{(phase "Placement" (play (move (from (handSite Mover)) (to (sites Empty)) (then (and (forEach Site (sites Incident Cell of:Vertex at:(last To)) (if (= 4 (count Sites in:(forEach (sites Incident Vertex of:Cell at:(site)) if:(is Mover (who at:(site)))))) (trigger "Win" Mover))) (set Counter))))) (nextPhase Mover (is Empty (handSite Mover)) "Movement")) (phase "Movement" (play (or (forEach Piece) (move Remove (sites Occupied by:Neutral)))))} (end {(if (is Triggered "Win" Mover) (result Mover Win)) (if (or (no Moves Mover) (= (counter) 49)) (result Mover Draw))}))) 