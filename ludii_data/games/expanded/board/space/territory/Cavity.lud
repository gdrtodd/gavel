(game "Cavity" (players 2) (equipment {(board (square 11) use:Vertex) (piece "Marker" Each)}) (rules (meta (swap)) phases:{(phase "Opening" (play (move Add (to (sites Empty)))) (nextPhase (and (= 1 (count Sites in:(sites Occupied by:P1))) (= 1 (count Sites in:(sites Occupied by:P2)))) "Play")) (phase "Play" (play (move Add (to (sites Empty) if:(> Infinity (count Steps Orthogonal (step (to if:(or (is Empty (to)) (is In (to) (sites Occupied by:Mover))))) (to) (sites Occupied by:Mover)))) (then (if (can Move (enclose (from (last To)) Orthogonal (between if:(is Enemy (who at:(between))) (apply (remove (between)))))) (enclose (from (last To)) Orthogonal (between if:(is Enemy (who at:(between))) (apply (remove (between))))) (enclose (from (last To)) Orthogonal (between if:(is Mover (who at:(between))) (apply (remove (between))))))))))} (end (forEach Player if:(and (< 2 (count Moves)) (no Pieces Player)) (result Player Loss))))) 