5x5 grid, with six spaces extending from the central row; the final three of this extension rendered as rectangles rather than squares (Cairo, Medina, and Mecca, in that order). The central square of the grid is marked with a circle (the Minaret). Any number of players. Three pieces per player, a father, a mother, and an angel. Six sticks, black on one side and white on the other, used as dice. The throws are as follows: Five of any color plus one of the other color (known as "sir") = 1, plus an extra throw; six white = an extra throw, and the player moves the number of white faces; six black = three extra throws, and the player moves the number of white faces up. Any other throws = 0. The angel moves double the values of these throws. The father begins on the top left corner space, the angel on the next space below it, and the mother on the space below the angel. Players move vertically in a boustrophedon track in the main grid, and when reaching the bottom right corner they progress into the extended row. Players must throw sir to enter the Minaret, and then another sir to exit it. To progress into the first three spaces of the extended row, a player must throw a sir to move one space. To enter each of the three final spaces (Cairo, Medina, and Mecca), a player must throw sir three times. Upon entering the extended row, the angel no longer moves double. When a player passes the piece of an opponent, the opponent's piece is sent back to the space where it started. The first player to move their three pieces to Mecca wins. The game has 4 players.
(game "Siryu (Race)" (players 4) (equipment {(board (merge {(rectangle 5 2) (shift 2 -3 (scale 1.2 1 (rectangle 8 1))) (shift 3.2 0 (rectangle 5 2)) (shift 1.6 -6 (scale 2 1 (rectangle 3 1)))}) {(track "FirstTrack" "13,S,E1,N,E1,S1" directed:True) (track "SecondTrack" "6,S1,E1,N,E1,S" directed:True)}) (dice d:2 from:0 num:6) (map "Throw" {(pair 0 6) (pair 1 1) (pair 2 0) (pair 3 0) (pair 4 0) (pair 5 1) (pair 6 6)}) (map "ExtraThrow" {(pair 0 1) (pair 1 1) (pair 2 0) (pair 3 0) (pair 4 0) (pair 5 1) (pair 6 3)}) (piece "Father" Each (if (notEqual 0 (mapEntry "Throw" (count Pips))) (or {(if (is In (from) (sites Track "FirstTrack")) (move (from (from) level:(level)) (to (trackSite Move "FirstTrack" steps:(mapEntry "Throw" (count Pips))))) (then (forEach Site (sites Track Mover "FirstTrack" from:(trackSite Move from:(last From) "FirstTrack" steps:1) to:(last To)) (forEach Level (site) FromTop (if (is Enemy (who at:(site) level:(level))) (fromTo (from (site) level:(level)) (to (if (equals (site) (where "Father" (who at:(site) level:(level)))) 13 (if (equals (site) (where "Mother" (who at:(site) level:(level)))) 7 10))))))))) (if (is In (from) (sites Track "SecondTrack")) (move (from (from) level:(level)) (to (trackSite Move "SecondTrack" steps:(mapEntry "Throw" (count Pips)))) (then (forEach Site (sites Track Mover "SecondTrack" from:(trackSite Move from:(last From) "SecondTrack" steps:1) to:(last To)) (forEach Level (site) FromTop (if (is Enemy (who at:(site) level:(level))) (fromTo (from (site) level:(level)) (to (if (equals (site) (where "Father" (who at:(site) level:(level)))) 13 (if (equals (site) (where "Mother" (who at:(site) level:(level)))) 7 10)))))))))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 12)) (move (from (from) level:(level)) (to 9))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 9)) (move (from (from) level:(level)) (to 6))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 23)) (move (from (from) level:(level)) (to 2))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 2)) (move (from (from) level:(level)) (to 17))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 17)) (move (from (from) level:(level)) (to 16))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (is In (from) (sites {16 29 30})) (lt (state at:(from) level:(level)) 2)}) (move (from (from) level:(level)) (to (from) (apply (set State at:(to) level:(level) (add 1 (state at:(to) level:(level)))))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 16) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 30 (apply (set State at:(from) level:(level) 0))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 30) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 29 (apply (set State at:(from) level:(level) 0))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 29) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 28 (apply (set State at:(from) level:(level) 0)))))}))) (piece "Angel" Each (if (notEqual 0 (mul 2 (mapEntry "Throw" (count Pips)))) (or {(if (is In (from) (sites Track "FirstTrack")) (move (from (from) level:(level)) (to (trackSite Move "FirstTrack" steps:(mul 2 (mapEntry "Throw" (count Pips)))))) (then (forEach Site (sites Track Mover "FirstTrack" from:(trackSite Move from:(last From) "FirstTrack" steps:1) to:(last To)) (forEach Level (site) FromTop (if (is Enemy (who at:(site) level:(level))) (fromTo (from (site) level:(level)) (to (if (equals (site) (where "Father" (who at:(site) level:(level)))) 13 (if (equals (site) (where "Mother" (who at:(site) level:(level)))) 7 10))))))))) (if (is In (from) (sites Track "SecondTrack")) (move (from (from) level:(level)) (to (trackSite Move "SecondTrack" steps:(mul 2 (mapEntry "Throw" (count Pips))))) (then (forEach Site (sites Track Mover "SecondTrack" from:(trackSite Move from:(last From) "SecondTrack" steps:1) to:(last To)) (forEach Level (site) FromTop (if (is Enemy (who at:(site) level:(level))) (fromTo (from (site) level:(level)) (to (if (equals (site) (where "Father" (who at:(site) level:(level)))) 13 (if (equals (site) (where "Mother" (who at:(site) level:(level)))) 7 10)))))))))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 12)) (move (from (from) level:(level)) (to 9))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 9)) (move (from (from) level:(level)) (to 6))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 23)) (move (from (from) level:(level)) (to 2))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 2)) (move (from (from) level:(level)) (to 17))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 17)) (move (from (from) level:(level)) (to 16))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 24)) (move (from (from) level:(level)) (to 2))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (is In (from) (sites {16 29 30})) (lt (state at:(from) level:(level)) 2)}) (move (from (from) level:(level)) (to (from) (apply (set State at:(to) level:(level) (add 1 (state at:(to) level:(level)))))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 16) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 30 (apply (set State at:(from) level:(level) 0))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 30) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 29 (apply (set State at:(from) level:(level) 0))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 29) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 28 (apply (set State at:(from) level:(level) 0)))))}))) (piece "Mother" Each (if (notEqual 0 (mapEntry "Throw" (count Pips))) (or {(if (is In (from) (sites Track "FirstTrack")) (move (from (from) level:(level)) (to (trackSite Move "FirstTrack" steps:(mapEntry "Throw" (count Pips))))) (then (forEach Site (sites Track Mover "FirstTrack" from:(trackSite Move from:(last From) "FirstTrack" steps:1) to:(last To)) (forEach Level (site) FromTop (if (is Enemy (who at:(site) level:(level))) (fromTo (from (site) level:(level)) (to (if (equals (site) (where "Father" (who at:(site) level:(level)))) 13 (if (equals (site) (where "Mother" (who at:(site) level:(level)))) 7 10))))))))) (if (is In (from) (sites Track "SecondTrack")) (move (from (from) level:(level)) (to (trackSite Move "SecondTrack" steps:(mapEntry "Throw" (count Pips)))) (then (forEach Site (sites Track Mover "SecondTrack" from:(trackSite Move from:(last From) "SecondTrack" steps:1) to:(last To)) (forEach Level (site) FromTop (if (is Enemy (who at:(site) level:(level))) (fromTo (from (site) level:(level)) (to (if (equals (site) (where "Father" (who at:(site) level:(level)))) 13 (if (equals (site) (where "Mother" (who at:(site) level:(level)))) 7 10)))))))))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 12)) (move (from (from) level:(level)) (to 9))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 9)) (move (from (from) level:(level)) (to 6))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 23)) (move (from (from) level:(level)) (to 2))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 2)) (move (from (from) level:(level)) (to 17))) (if (and (equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 17)) (move (from (from) level:(level)) (to 16))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (is In (from) (sites {16 29 30})) (lt (state at:(from) level:(level)) 2)}) (move (from (from) level:(level)) (to (from) (apply (set State at:(to) level:(level) (add 1 (state at:(to) level:(level)))))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 16) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 30 (apply (set State at:(from) level:(level) 0))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 30) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 29 (apply (set State at:(from) level:(level) 0))))) (if (and {(equals (mapEntry "Throw" (count Pips)) 1) (equals (from) 29) (equals 2 (state at:(from) level:(level)))}) (move (from (from) level:(level)) (to 28 (apply (set State at:(from) level:(level) 0)))))})))}) (rules (start {(place Stack "Father1" 13) (place Stack "Angel1" 10) (place Stack "Mother1" 7) (place Stack "Father2" 13) (place Stack "Angel2" 10) (place Stack "Mother2" 7) (place Stack "Father3" 13) (place Stack "Angel3" 10) (place Stack "Mother3" 7) (place Stack "Father4" 13) (place Stack "Angel4" 10) (place Stack "Mother4" 7)}) (play (do (roll) next:(forEach Piece) (then (if (notEqual 0 (mapEntry "ExtraThrow" (count Pips))) (and (if (equals 3 (mapEntry "ExtraThrow" (count Pips))) (if (le (var) 0) (set Var 2) (set Var (add 2 (var))))) (moveAgain)) (if (gt (var) 0) (and (set Var (sub (var) 1)) (moveAgain))))))) (end (if (and {(equals 28 (where "Angel" Mover)) (equals 28 (where "Father" Mover)) (equals 28 (where "Mother" Mover))}) (result Mover Win))))) 
