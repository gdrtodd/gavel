TURN - On each turn, each player drops a friendly stone on an empty cell. If a diagonal line is full (i.e., there are no empty cells on that diagonal), the player who dropped the last stone achieves so many points as the number of friendly stones on the finished line. Two lines can be finished on one turn, the player achieves points for both lines (the dropped stone counts twice, once for each diagonal). A diagonal line must have at least 2 stones. So, corner cells do not count as diagonals. GOAL - When all cells are occupied, wins the player with more points.
(game "Diagonals" (players 2) (equipment {(board (square 8) use:Vertex) (piece "Ball" Each)}) (rules (play (move Add (to (sites Empty)) (then (and (if (not (is In (last To) (sites {"A8" "H1"}))) (if (all Sites (union (sites Direction from:(last To) NE included:True) (sites Direction from:(last To) SW)) if:(is Occupied (site))) (addScore Mover (count Sites in:(forEach (union (sites Direction from:(last To) NE included:True) (sites Direction from:(last To) SW)) if:(is Friend (who at:(site)))))))) (if (not (is In (last To) (sites {"A1" "H8"}))) (if (all Sites (union (sites Direction from:(last To) SE included:True) (sites Direction from:(last To) NW)) if:(is Occupied (site))) (addScore Mover (count Sites in:(forEach (union (sites Direction from:(last To) SE included:True) (sites Direction from:(last To) NW)) if:(is Friend (who at:(site)))))))))))) (end (if (is Full) (byScore))))) 
