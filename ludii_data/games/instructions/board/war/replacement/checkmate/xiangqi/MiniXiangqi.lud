The rules for pieces are the same as regular Xiangqi, except pawns start with the ability to move sideways.
(game "MiniXiangqi" (players {(player N) (player S)}) (equipment {(board (rectangle 7 7) use:Vertex) (piece "Jiang" Each (move Step Orthogonal (to if:(and (is In (to) (sites Mover "Palace")) (not (is Friend (who at:(to))))) (apply (remove (to)))))) (piece "Ma" Each (forEach Direction Orthogonal (to if:(is Empty (to)) (apply (forEach Direction (from (to)) (directions {FR FL} of:All) (if (not (is Friend (who at:(to)))) (move (from) (to (apply if:(is Enemy (who at:(to))) (remove (to))))))))))) (piece "Ju" Each (move Slide Orthogonal (to if:(is Enemy (who at:(to))) (apply (remove (to)))))) (piece "Pao" Each (or (move Slide Orthogonal) (move Hop Orthogonal (between before:(count Rows) after:(count Rows) if:(is Occupied (between))) (to if:(is Empty (to)) (apply if:(is Enemy (who at:(to))) (remove (to))))))) (piece "Zu" Each (move Step (directions {Forward Rightward Leftward}) (to if:(not (is Friend (who at:(to)))) (apply (remove (to)))))) (regions "PalaceP1" P1 {2 3 4 9 10 11 16 17 18}) (regions "PalaceP2" P2 {30 31 32 37 38 39 44 45 46})}) (rules (start {(place "Jiang1" coord:"D1") (place "Ma1" {"C1" "E1"}) (place "Ju1" {"A1" "G1"}) (place "Pao1" {"B1" "F1"}) (place "Zu1" {"A2" "C2" "D2" "E2" "G2"}) (place "Jiang2" coord:"D7") (place "Ma2" {"C7" "E7"}) (place "Ju2" {"A7" "G7"}) (place "Pao2" {"B7" "F7"}) (place "Zu2" {"A6" "C6" "D6" "E6" "G6"})}) (play (do (forEach Piece) ifAfterwards:(and (if (equals (column of:(where "Jiang" P1)) (column of:(where "Jiang" P2))) (not (equals (count Sites in:(forEach (sites Direction from:(where "Jiang" P1) N stop:(equals (to) (where "Jiang" P2))) if:(is Occupied (site)))) 0)) True) (not (is Threatened (id "Jiang" Mover)))))) (end {(if (and (is Threatened (id "Jiang" Next)) (not (can Move (do (forEach Piece Next) ifAfterwards:(not (is Threatened (id "Jiang" Next))))))) (result Mover Win)) (if (no Moves Next) (result Mover Win))}))) 
