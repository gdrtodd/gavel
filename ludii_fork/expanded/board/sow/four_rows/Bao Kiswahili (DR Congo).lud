4x8 board. The fifth hole from the left in the inner row is rectangular, the rest are circular. 64 counters. Play begins with one counter in each hole in the inner row. Players take turns placing their remaining counters on the board in their inner rows. When they place a counter, they capture the hole facing it in the opponent's inner row, and sows the counters from either the leftmost or the rightmost hole of the player's inner row, sowing along the inner row. However, if the capture occurs from the rightmost, leftmost, or the next hole adjacent to each in the inner row, the captured pieces must be placed in the leftmost or rightmost hole, whichever is closer. The player may choose which hole to place captured counters in when captures are made from the central four holes in the inner row. The player must capture if possible, if not possible they place a counter into any of the holes in their inner row, pick up the contents of that hole, and sow in either direction. While sowing, if the final counter falls into an occupied hole and the opponent's hole opposite it has counters, the counters in the opponent's hole are captured. If the final counter falls into an occupied hole and the hole opposite it is empty, the counters are picked up and sowing continues in the same direction. If the final counter falls into an empty hole, the turn ends. If during this phase, the opponent's inner row is cleared of counters, the player wins. If all of the counters have been introduced and both players still have counters in their inner row, play proceeds to a second phase. Second Phase: Counters are picked up from any hole on the player's side and sown in either direction. The same capture, sowing, and victory rules apply as before. Captures, however, can only be made on subsequent sowings if there was a capture in the first round of a sowing.
(game "Bao Kiswahili (DR Congo)" (players 2) (equipment {(mancalaBoard 4 8 store:None {(track "TrackCCW1" "0,E,N1,W" loop:True P1) (track "TrackCCW2" "16,E,N1,W" loop:True P2) (track "TrackCW1" "7,W,N1,E" loop:True P1) (track "TrackCW2" "23,W,N1,E" loop:True P2)}) (piece "Seed" Shared) (hand Each) (regions "Home" P1 (expand (sites Bottom))) (regions "Home" P2 (expand (sites Top))) (regions "Inner" P1 (sites Row 1)) (regions "Inner" P2 (sites Row 2)) (map "LeftMostInner" {(pair P1 8) (pair P2 23)}) (map "RightMostInner" {(pair P1 15) (pair P2 16)}) (map "AdjacentLeftMostInner" {(pair P1 9) (pair P2 22)}) (map "AdjacentRightMostInner" {(pair P1 14) (pair P2 17)})}) (rules (start {(set Count 24 at:(handSite P1)) (set Count 24 at:(handSite P2)) (set Count 1 to:(union (sites Row 1) (sites Row 2)))}) phases:{(phase "Placement" (play (if (is Prev Mover) (if (is Pending) (or (if (or (equals 1 (value Player Mover)) (equals 0 (value Player Mover))) (do (fromTo (from (if (is Mover P1) (add (last To afterConsequence:True) 8) (sub (last To afterConsequence:True) 8))) (to (mapEntry "LeftMostInner" Mover)) count:(count at:(if (is Mover P1) (add (last To afterConsequence:True) 8) (sub (last To afterConsequence:True) 8)))) next:(move Select (from (mapEntry "LeftMostInner" Mover)) (then (sow "TrackCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (add (to) 8) (sub (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)})))))))) (if (or (equals 2 (value Player Mover)) (equals 0 (value Player Mover))) (do (fromTo (from (if (is Mover P1) (add (last To afterConsequence:True) 8) (sub (last To afterConsequence:True) 8))) (to (mapEntry "RightMostInner" Mover)) count:(count at:(if (is Mover P1) (add (last To afterConsequence:True) 8) (sub (last To afterConsequence:True) 8)))) next:(move Select (from (mapEntry "RightMostInner" Mover)) (then (sow "TrackCCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (add (to) 8) (sub (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))))))))) (or (if (or (equals (var "Direction") 1) (equals (var "Direction") 3)) (move Select (from (var "Replay")) (then (sow "TrackCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (add (to) 8) (sub (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))))))) (if (or (equals (var "Direction") 2) (equals (var "Direction") 3)) (move Select (from (var "Replay")) (then (sow "TrackCCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (add (to) 8) (sub (to) 8))) (and {(moveAgain) (set Pending) (if (is In (to) (expand (sites Right))) (set Value Mover 2) (if (is In (to) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))) (if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))))))))) (if (is Occupied (handSite Mover)) (priority {(move (from (handSite Mover)) (to (sites Mover "Inner") if:(is Occupied (if (is Mover P1) (add (to) 8) (sub (to) 8)))) count:1 (then (and {(moveAgain) (set Pending) (if (is In (last To) (expand (sites Right))) (set Value Mover 2) (if (is In (last To) (expand (sites Left))) (set Value Mover 1) (set Value Mover 0)))}))) (move (from (handSite Mover)) (to (sites Mover "Inner")) count:1 (then (and {(moveAgain) (set Var "Replay" (last To)) (set Var "Direction" 3)})))}) (or (move Select (from (sites Mover) if:(is Occupied (from))) (then (sow "TrackCW" owner:(mover) apply:(if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 1)}))))) (move Select (from (sites Mover) if:(is Occupied (from))) (then (sow "TrackCCW" owner:(mover) apply:(if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to)) (set Var "Direction" 2)}))))))))))} (end (forEach Player if:(all Sites (sites Player "Inner") if:(equals 0 (count at:(site)))) (result Player Loss))))) 
