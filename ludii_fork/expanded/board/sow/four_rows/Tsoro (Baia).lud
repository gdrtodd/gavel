4x13-19 board. Two counters in every hole, except the leftmost in both of a player's rows, which are empty, and the second from the left in the inner row, which has one. Sowing occurs in an anti-clockwise direction. When the final counter lands in an occupied hole, these counters are picked up and sowing continues. Captures are made when the final counters lands in an empty hole in the inner row, capturing the contents of the opponent's opposite inner row hole, as well as the contents of the outer row hole only if there was a capture from the inner row hole. Captures from extra holes are also made, which are graduated based on the number of captures the player has made. On their first turn, players sow from the third hole from the left in the front row. This triggers a capture of the counters in the opposite holes in the opponent's inner and outer rows, plus the contents of any other five holes on the opponent's side of the board. In subsequent turns, sowing must occur from a hole which follows an empty hole according to the circuit of the holes. On their second capture, the player captures three extra holes. All other subsequent captures capture from two extra holes. Sowing a single counter cannot result in a capture. The player who captures all of their opponent's counters wins. Each row has 13 holes.
(game "Tsoro (Baia)" (players 2) (equipment {(mancalaBoard 4 13 store:None {(track "TrackCCW1" "0,E,N1,W" loop:True P1) (track "TrackCCW2" "26,E,N1,W" loop:True P2) (track "TrackCW1" "12,W,N1,E" loop:True P1) (track "TrackCW2" "39,E,S1,W" loop:True P2)}) (regions "Home" P1 (sites Track "TrackCCW1")) (regions "Home" P2 (sites Track "TrackCCW2")) (regions "Inner" P1 (difference (sites Track "TrackCCW1") (sites Bottom))) (regions "Inner" P2 (difference (sites Track "TrackCCW2") (sites Top))) (regions "Outer" P1 (sites Bottom)) (regions "Outer" P2 (sites Top)) (regions "FirstMove" P1 (difference (expand (intersection (difference (sites Track "TrackCCW1") (sites Bottom)) (sites Left)) steps:2 E) (expand (intersection (difference (sites Track "TrackCCW1") (sites Bottom)) (sites Left)) E))) (regions "FirstMove" P2 (difference (expand (intersection (difference (sites Track "TrackCCW2") (sites Top)) (sites Right)) steps:2 W) (expand (intersection (difference (sites Track "TrackCCW2") (sites Top)) (sites Right)) W))) (piece "Seed" Shared) (hand Each)}) (rules (start {(set Count 2 to:(difference (sites P1 "Outer") (sites Left))) (set Count 2 to:(difference (sites P2 "Outer") (sites Right))) (set Count 2 to:(difference (sites P1 "Inner") (expand (sites Left)))) (set Count 2 to:(difference (sites P2 "Inner") (expand (sites Right)))) (set Count 1 to:(difference (sites P1 "Inner") (union (sites Left) (difference (sites P1 "Inner") (expand (sites Left)))))) (set Count 1 to:(difference (sites P2 "Inner") (union (sites Right) (difference (sites P2 "Inner") (expand (sites Right))))))}) phases:{(phase "FirstTurn" (play (if (ge 0 (var "FreeCapture")) (move Select (from (sites Mover "FirstMove")) (then (sow "TrackCCW" owner:(mover) apply:(if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (add (to) 13) (sub (to) 13))) (and {(fromTo (from (if (is Mover P1) (add (to) 13) (sub (to) 13))) (to (handSite Mover)) count:(count at:(if (is Mover P1) (add (to) 13) (sub (to) 13)))) (if (is Occupied (if (is Mover P1) (add (to) (mul 13 2)) (sub (to) (mul 13 2)))) (fromTo (from (if (is Mover P1) (add (to) (mul 13 2)) (sub (to) (mul 13 2)))) (to (handSite Mover)) count:(count at:(if (is Mover P1) (add (to) (mul 13 2)) (sub (to) (mul 13 2)))))) (set Value Mover (add 1 (value Player Mover))) (set Var "FreeCapture" 5) (moveAgain)})))))) (move (from (sites Next "Home") if:(and (is Occupied (from)) (not (is In (from) (sites Next "FirstMove"))))) (to (handSite Mover)) count:(count at:(from)) (then (and (set Var "FreeCapture" (sub (var "FreeCapture") 1)) (if (lt 1 (var "FreeCapture")) (moveAgain))))))) (nextPhase Mover (not (is Next Mover)) "Main")) (phase "Main" (play (if (ge 0 (var "FreeCapture")) (or (move Select (from (if (is Prev Mover) (sites {(var "Replay")}) (sites Mover "Home")) if:(and (lt 1 (count at:(from))) (if (is Prev Mover) True (is Empty (trackSite Move from:(from) "TrackCW" steps:1))))) (then (sow "TrackCCW" owner:(mover) apply:(if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to))}) (if (is In (to) (sites Mover "Inner")) (if (is Occupied (if (is Mover P1) (add (to) 13) (sub (to) 13))) (and {(fromTo (from (if (is Mover P1) (add (to) 13) (sub (to) 13))) (to (handSite Mover)) count:(count at:(if (is Mover P1) (add (to) 13) (sub (to) 13)))) (if (is Occupied (if (is Mover P1) (add (to) (mul 13 2)) (sub (to) (mul 13 2)))) (fromTo (from (if (is Mover P1) (add (to) (mul 13 2)) (sub (to) (mul 13 2)))) (to (handSite Mover)) count:(count at:(if (is Mover P1) (add (to) (mul 13 2)) (sub (to) (mul 13 2)))))) (set Value Mover (add 1 (value Player Mover))) (if (equals 0 (value Player Mover)) (set Var "FreeCapture" 3) (set Var "FreeCapture" 2)) (moveAgain)}))))))) (move Select (from (if (is Prev Mover) (sites {(var "Replay")}) (sites Mover "Home")) if:(and (equals 1 (count at:(from))) (if (is Prev Mover) True (is Empty (trackSite Move from:(from) "TrackCW" steps:1))))) (then (sow "TrackCCW" owner:(mover) apply:(if (lt 1 (count at:(to))) (and {(moveAgain) (set Var "Replay" (to))})))))) (move (from (sites Next "Home") if:(and (is Occupied (from)) (not (is In (from) (sites Next "FirstMove"))))) (to (handSite Mover)) count:(count at:(from)) (then (and (set Var "FreeCapture" (sub (var "FreeCapture") 1)) (if (lt 1 (var "FreeCapture")) (moveAgain))))))))} (end (forEach NonMover if:(all Sites (sites Player) if:(equals 0 (count at:(site)))) (result Player Loss))))) 
