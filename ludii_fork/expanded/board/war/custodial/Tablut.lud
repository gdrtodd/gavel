The central square is the castle, which cannot be entered by pieces or by the king once it has left. There are two sides: one with the king and 8 pieces, another with 16 undifferentiated pieces. The king begins on the castle space, and his associated pieces are arranged with two pieces on each orthogonal side of the king. The opposing side is arranged on the sides of the board, one piece on each of the three central squares on each of the four sides, and one further piece on the next row in on the central square of the row. Pieces move orthogonally any number of squares. Pieces cannot jump. If a piece is caught between two opposing pieces, it is removed from play. A piece may also be captured by trapping it between an enemy piece and the castle. The king, when in the castle, can only be captured when surrounded on four sides. If it is in a space adjacent to one of the sides, it can be captured when the opponent surrounds it on the remaining three sides. Otherwise, it is captured like any other piece. If the king moves to the edge of the board, the player controlling the king wins. If the opposing side captures the king, they win. The king is captured if the enemy flanks him, except on the castle where he should be surrounded.
(game "Tablut" (players 2) (equipment {(board (square 9)) (piece "Thrall" P1 (move Slide Orthogonal (between if:(and (notEqual (between) (centrePoint)) (is Empty (between)))) (then (or {(custodial (from (last To)) Orthogonal (between (max 1) if:(equals (what at:(between)) (id "Thrall2")) (apply (remove (between)))) (to if:(or (is Friend (who at:(to))) (equals (to) (centrePoint))))) (surround (from (last To)) Orthogonal (between if:(and (equals (what at:(between)) (id "Jarl2")) (or (equals (between) (centrePoint)) (is In (between) (sites "OrthogonalSitesCentre")))) (apply (trigger "Surrounded" P2))) (to if:(or (is Friend (who at:(to))) (equals (to) (centrePoint))))) (custodial (from (last To)) Orthogonal (between (max 1) if:(and (equals (what at:(between)) (id "Jarl2")) (and (notEqual (between) (centrePoint)) (not (is In (between) (sites "OrthogonalSitesCentre"))))) (apply (trigger "Surrounded" P2))) (to if:(is Friend (who at:(to)))))})))) (piece "Thrall" P2 (move Slide Orthogonal (between if:(and (notEqual (between) (centrePoint)) (is Empty (between)))) (then (custodial (from (last To)) Orthogonal (between (max 1) if:(equals (what at:(between)) (id "Thrall1")) (apply (remove (between)))) (to if:(or (is Friend (who at:(to))) (equals (to) (centrePoint)))))))) (piece "Jarl" P2 (move Slide Orthogonal (between if:(and (notEqual (between) (centrePoint)) (is Empty (between)))) (then (custodial (from (last To)) Orthogonal (between (max 1) if:(equals (what at:(between)) (id "Thrall1")) (apply (remove (between)))) (to if:(or (is Friend (who at:(to))) (equals (to) (centrePoint)))))))) (regions "OrthogonalSitesCentre" (difference (expand origin:(centrePoint) Orthogonal) (centrePoint)))}) (rules (start {(place "Thrall1" {"D1" "E1" "F1" "E2" "A4" "A5" "A6" "B5" "I4" "I5" "I6" "H5" "E8" "D9" "E9" "F9" "E8"}) (place "Thrall2" {"E3" "E4" "E6" "E7" "C5" "D5" "F5" "G5"}) (place "Jarl2" (centrePoint))}) (play (forEach Piece)) (end {(if (is Within (id "Jarl2") in:(sites Outer)) (result P2 Win)) (if (is Triggered "Surrounded" P2) (result P1 Win))}))) 
